---
# cert-manager installation namespace
apiVersion: v1
kind: Namespace
metadata:
  name: cert-manager
  labels:
    name: cert-manager
---
# Note: For production, install cert-manager using Helm chart
# This provides complete CRD installation and controller deployment
#
# Installation command:
# kubectl apply -f https://github.com/cert-manager/cert-manager/releases/download/v1.16.2/cert-manager.crds.yaml
# helm repo add jetstack https://charts.jetstack.io
# helm repo update
# helm install cert-manager jetstack/cert-manager \
#   --namespace cert-manager \
#   --create-namespace \
#   --version v1.16.2
---
# ClusterIssuer for Let's Encrypt Production
apiVersion: cert-manager.io/v1
kind: ClusterIssuer
metadata:
  name: letsencrypt-prod
spec:
  acme:
    server: https://acme-v02.api.letsencrypt.org/directory
    email: admin@clpr.tv  # TODO: Replace with your monitored email for Let's Encrypt notifications
    privateKeySecretRef:
      name: letsencrypt-prod-key
    solvers:
      - http01:
          ingress:
            class: nginx
---
# ClusterIssuer for Let's Encrypt Staging (for testing)
apiVersion: cert-manager.io/v1
kind: ClusterIssuer
metadata:
  name: letsencrypt-staging
spec:
  acme:
    server: https://acme-staging-v02.api.letsencrypt.org/directory
    email: admin@clpr.tv  # TODO: Replace with your monitored email for Let's Encrypt notifications
    privateKeySecretRef:
      name: letsencrypt-staging-key
    solvers:
      - http01:
          ingress:
            class: nginx
---
# DNS01 ClusterIssuer for wildcard certificates (AWS Route53 example)
apiVersion: cert-manager.io/v1
kind: ClusterIssuer
metadata:
  name: letsencrypt-dns-prod
spec:
  acme:
    server: https://acme-v02.api.letsencrypt.org/directory
    email: admin@clpr.tv
    privateKeySecretRef:
      name: letsencrypt-dns-prod-key
    solvers:
      - dns01:
          route53:
            region: us-east-1  # Update with your region
            # Use IAM role for service account (IRSA) or access keys
            # For IRSA, configure serviceAccountRef
---
# DNS01 ClusterIssuer for wildcard certificates (GCP Cloud DNS example)
apiVersion: cert-manager.io/v1
kind: ClusterIssuer
metadata:
  name: letsencrypt-dns-gcp
spec:
  acme:
    server: https://acme-v02.api.letsencrypt.org/directory
    email: admin@clpr.tv
    privateKeySecretRef:
      name: letsencrypt-dns-gcp-key
    solvers:
      - dns01:
          cloudDNS:
            project: clipper-prod  # Update with your GCP project
            # Use workload identity for authentication
---
# DNS01 ClusterIssuer for wildcard certificates (Azure DNS example)
apiVersion: cert-manager.io/v1
kind: ClusterIssuer
metadata:
  name: letsencrypt-dns-azure
spec:
  acme:
    server: https://acme-v02.api.letsencrypt.org/directory
    email: admin@clpr.tv
    privateKeySecretRef:
      name: letsencrypt-dns-azure-key
    solvers:
      - dns01:
          azureDNS:
            subscriptionID: "00000000-0000-0000-0000-000000000000"  # TODO: Replace with your Azure subscription ID
            resourceGroupName: "clipper-dns-rg"  # Update
            hostedZoneName: "clpr.tv"  # Update
            # Use managed identity or service principal
