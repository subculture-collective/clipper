# Staging deployment configuration for Clipper

global:
  domain: staging.clpr.tv
  environment: staging

backend:
  enabled: true

frontend:
  enabled: true

postgres:
  enabled: true

redis:
  enabled: true

clipper-backend:
  replicaCount: 2
  image:
    repository: ghcr.io/subculture-collective/clipper-backend
    pullPolicy: Always
    tag: "develop"
  
  resources:
    requests:
      cpu: 100m
      memory: 256Mi
    limits:
      cpu: 500m
      memory: 512Mi
  
  autoscaling:
    enabled: true
    minReplicas: 2
    maxReplicas: 5
  
  ingress:
    enabled: true
    className: nginx
    annotations:
      cert-manager.io/cluster-issuer: "letsencrypt-staging"
    hosts:
      - host: staging.clpr.tv
        paths:
          - path: /api
            pathType: Prefix
    tls:
      - secretName: clipper-staging-tls
        hosts:
          - staging.clpr.tv
  
  config:
    ENVIRONMENT: "staging"
    GIN_MODE: "release"
    LOG_LEVEL: "debug"
    BASE_URL: "https://staging.clpr.tv"
    SENTRY_ENABLED: "true"
    SENTRY_ENVIRONMENT: "staging"
    SENTRY_TRACES_SAMPLE_RATE: "1.0"

clipper-frontend:
  replicaCount: 2
  image:
    repository: ghcr.io/subculture-collective/clipper-frontend
    pullPolicy: Always
    tag: "develop"
  
  resources:
    requests:
      cpu: 50m
      memory: 64Mi
    limits:
      cpu: 200m
      memory: 256Mi
  
  autoscaling:
    enabled: true
    minReplicas: 2
    maxReplicas: 5
  
  ingress:
    enabled: true
    className: nginx
    annotations:
      cert-manager.io/cluster-issuer: "letsencrypt-staging"
      nginx.ingress.kubernetes.io/ssl-redirect: "true"
    hosts:
      - host: staging.clpr.tv
        paths:
          - path: /
            pathType: Prefix
    tls:
      - secretName: clipper-staging-tls
        hosts:
          - staging.clpr.tv

clipper-postgres:
  persistence:
    enabled: true
    size: 20Gi
    storageClassName: local-path

clipper-redis:
  persistence:
    enabled: true
    size: 5Gi
    storageClassName: local-path
